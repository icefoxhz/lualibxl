---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by saber.
--- DateTime: 2022/6/19 22:20
---
--require("mobdebug").start("localhost", 8172) --默认值为 "localhost", 8172

local model = require("lualibxlCore")

function test1()
    local execl = model.newExecl()
    if model.openFile(execl, "D:\\1.xlsx") then
        if model.addReadSheet(execl, "测试1") then
        end

        if model.setCurrentSheet(execl, 0) then
            model.writeCurrentSheet(execl, 15, 3, "你好 lua")
            model.writeCurrentSheet(execl, 16, 3, "阿斯顿发斯蒂芬斯蒂芬")
        end
        print("SheetCount = ", model.getSheetCount(execl))
        model.closeFile(execl)
    end
    execl = nil
end

function test2()
    local execl = model.newExecl()
    if model.openFile(execl, "D:\\1.xlsx") then
        if model.setCurrentSheet(execl, 0) then
            local val1 = model.readCurrentSheet(execl, 15, 3)
            local val2 = model.readCurrentSheet(execl, 16, 3)
            print(val1, val2)
        end

        model.closeFile(execl)
    end
    execl = nil
end

function test3()
    local execl1 = model.newExecl()
    local execl2 = model.newExecl()

    print(execl1, execl2)

    if model.openFile(execl1, "D:\\1.xlsx") and model.openFile(execl2, "D:\\2.xlsx") then
        --print("open ok")
        if model.setCurrentSheet(execl1, 0) then
            --print("setCurrentSheet execl1 ok")
            local val1 = model.readCurrentSheet(execl1, 15, 3)
            local val2 = model.readCurrentSheet(execl1, 16, 3)
            print(val1, val2)

            model.addReadSheet(execl2, "测试2")
            if model.setCurrentSheet(execl2, 0) then
                --print("setCurrentSheet execl2 ok")
                model.writeCurrentSheet(execl2, 1, 3, val1)
                model.writeCurrentSheet(execl2, 2, 3, val2)
            end
        end
    end

    model.closeFile(execl1)
    model.closeFile(execl2)

    execl1 = nil
    execl2 = nil
end

function test4()
    local execl = model.newExecl()
    -- 要实现这种写法才好
    if execl:openFile("D:\\1.xlsx") then
        print("open ok")
    end
end

-- -------------------------------------------------
test1()
test2()
--test3()
--test4()

