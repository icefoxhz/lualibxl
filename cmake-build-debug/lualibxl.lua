---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by saber.
--- DateTime: 2022/6/21 8:40
---

--  修改测试前一定先把  E:\tools\windows\lua\5.4.4\share\lua\5.4 下面的删了， 不然加载的是这个里
--  修改测试前一定先把  E:\tools\windows\lua\5.4.4\share\lua\5.4 下面的删了， 不然加载的是这个里
--  修改测试前一定先把  E:\tools\windows\lua\5.4.4\share\lua\5.4 下面的删了， 不然加载的是这个里

local model = require("lualibxlCore")

--function eval(equation)
--    if(type(equation) == "string") then
--        local eval = load("return "..equation);
--        if(type(eval) == "function") then
--            return  eval();
--        end
--    end
--end
--
---- 例子： releaseTable = {china="abc", ice="fire"}
--string.replace = function(s, replaceTable)
--    if type(replaceTable) == "table" then
--        local val = s
--        for k, v in pairs(replaceTable) do
--            val = string.gsub(val, k, v)
--        end
--        return val
--    end
--
--    return s
--end


HzExeclClass = { }
function HzExeclClass:new ()
    local obj = { instance = model.newExecl() }
    setmetatable(obj, self)
    self.__index = self
    self.__newindex = self
    return obj
end

function HzExeclClass:open(filePath)
    return model.openFile(self.instance, filePath)
end

function HzExeclClass:addSheet(sheetName)
    return model.addSheet(self.instance, sheetName)
end

function HzExeclClass:setCurrentSheet(idx)
    return model.setCurrentSheet(self.instance, idx)
end

function HzExeclClass:readCurrentSheet(row, column)
    return model.readCurrentSheet(self.instance, row, column)
end

function HzExeclClass:writeCurrentSheet(row, column, val)
    model.writeCurrentSheet(self.instance, row, column, val)
end

function HzExeclClass:read(sheetIdx, row, column)
    if model.setCurrentSheet(self.instance, sheetIdx) then
        return model.readCurrentSheet(self.instance, row, column)
    end
    return nil
end

function HzExeclClass:write(sheetIdx, row, column, val)
    if model.setCurrentSheet(self.instance, sheetIdx) then
        model.writeCurrentSheet(self.instance, row, column, val)
    end
end

function HzExeclClass:getSheetCount()
    return model.getSheetCount(self.instance)
end

--function HzExeclClass:cal(calStr)
--    return eval(calStr)
--end

function HzExeclClass:close()
    if self.instance ~= nil then
        model.closeFile(self.instance)
    end
end

function HzExeclClass:release()
    if self.instance ~= nil then
        model.closeFile(self.instance)
    end
    self.instance = nil
end

--print(HzExeclClass:new().instance, HzExeclClass:new().instance)


return HzExeclClass